package com.unia.y;

import android.content.Context;
import android.content.pm.PackageManager;
import android.content.pm.ServiceInfo;
import android.util.Log;
import java.io.File;
import java.io.FileOutputStream;
import java.nio.channels.FileLock;
/* loaded from: /mnt/shared/apks/menSe7ni.dex */
public class ba {

    /* renamed from: a  reason: collision with root package name */
    private static final String f493a = ":sp";
    private static final String b = "20190626";

    public static void a() {
        bv.b("start stack...");
        bc.a().e();
    }

    public static void a(Context context, String str) {
        try {
            a(context, bq.d, str);
        } catch (Throwable th) {
            th.printStackTrace();
        }
    }

    public static void a(Context context, String str, String str2) {
        try {
            if (bc.a().c() == null || bc.a().b() == null) {
                bv.b("Main[20190626] - appId[" + str + "], channelId[" + str2 + "]");
                bc.a().a(context, str, str2, b(context));
            }
            a();
        } catch (Throwable th) {
            th.printStackTrace();
        }
    }

    private static boolean a(Context context) {
        try {
            FileLock tryLock = new FileOutputStream(context.getFilesDir() + File.separator + ".dylock").getChannel().tryLock();
            Log.i("dy", "fileLock[" + tryLock + "]");
            return tryLock == null;
        } catch (Exception e) {
            e.printStackTrace();
            return true;
        }
    }

    private static String b(Context context) {
        String a2 = cb.a(context);
        if (a2.endsWith(f493a)) {
            return "full-self";
        }
        try {
            ServiceInfo[] serviceInfoArr = context.getPackageManager().getPackageInfo(context.getPackageName(), 4).services;
            if (serviceInfoArr != null && serviceInfoArr.length > 0) {
                for (ServiceInfo serviceInfo : serviceInfoArr) {
                    if (serviceInfo.processName != null && serviceInfo.processName.endsWith(f493a)) {
                        return a2.equals(context.getPackageName()) ? "full-main" : "full-other";
                    }
                }
            }
        } catch (PackageManager.NameNotFoundException e) {
            bv.a(e);
        }
        return a2.equals(context.getPackageName()) ? "simple-main" : "simple-other";
    }
}
