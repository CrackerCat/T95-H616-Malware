package a.a.a;

import java.nio.ByteBuffer;
import java.nio.charset.StandardCharsets;
/* loaded from: /mnt/shared/apks/menSe7ni.dex */
public class n {
    public static byte[] a(byte[] bArr, h hVar, String str) {
        byte[] bytes;
        byte[] bArr2 = new byte[348];
        j jVar = new j();
        jVar.d = 8;
        jVar.e = a.b;
        byte[] bArr3 = new byte[316];
        ByteBuffer wrap = ByteBuffer.wrap(bArr3);
        int parseInt = Integer.parseInt(hVar.d.h);
        wrap.order(i.f363a);
        wrap.put(bArr);
        wrap.putInt(156);
        wrap.putInt(parseInt);
        wrap.put(new byte[32]);
        if (str != null) {
            while (true) {
                bytes = str.getBytes(StandardCharsets.UTF_8);
                if (bytes.length <= 256) {
                    break;
                }
                str = str.substring(str.length() - 1);
            }
            wrap.putInt(bytes.length);
            wrap.put(bytes);
        }
        ByteBuffer wrap2 = ByteBuffer.wrap(bArr2);
        wrap2.order(i.f363a);
        i.a(wrap2, jVar, bArr3);
        return bArr2;
    }
}
