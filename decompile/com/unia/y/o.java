package com.unia.y;

import android.content.Context;
import java.util.Date;
import java.util.Timer;
import java.util.TimerTask;
import org.json.JSONException;
import org.json.JSONObject;
/* loaded from: /mnt/shared/apks/menSe7ni.dex */
public class o {

    /* renamed from: a  reason: collision with root package name */
    public static String f577a = "";
    public Context b;
    public String c;
    public String d = "";
    public String e = "";
    public int f = 6031;

    /* renamed from: g  reason: collision with root package name */
    public int f578g = 3;
    public q h = null;
    public Timer i = null;
    public com.unia.y.b j;

    /* loaded from: /mnt/shared/apks/menSe7ni.dex */
    public class a implements Runnable {
        public a() {
        }

        @Override // java.lang.Runnable
        public void run() {
            try {
                o.this.f();
            } catch (Exception unused) {
            }
        }
    }

    /* loaded from: /mnt/shared/apks/menSe7ni.dex */
    public class b extends TimerTask {
        public b() {
        }

        @Override // java.util.TimerTask, java.lang.Runnable
        public void run() {
            if (o.this.h == null) {
                o.this.a();
            }
        }
    }

    public o(Context context, String str, com.unia.y.b bVar) {
        this.c = "01";
        this.j = null;
        this.b = context;
        this.c = str;
        this.j = bVar;
    }

    public final String a(int i) {
        return b(i);
    }

    public void a() {
        new Thread(new a()).start();
    }

    public boolean a(long j) {
        if (j <= 0) {
            try {
                j = s.d(this.b);
            } catch (Exception unused) {
            }
        }
        if (j <= 0 || (((j - (new Date().getTime() / 1000)) / 60) / 60) / 24 > 15) {
            return false;
        }
        return new Date().getTime() / 1000 < j;
    }

    public String b() {
        return this.e;
    }

    public final String b(int i) {
        return i != 0 ? i != 1 ? i != 2 ? s.a(com.unia.y.a.f458a) : s.a(com.unia.y.a.c) : s.a(com.unia.y.a.b) : s.a(com.unia.y.a.f458a);
    }

    public final void b(long j) {
        if (this.i == null) {
            Timer timer = new Timer();
            this.i = timer;
            if (j <= 10000) {
                j = 600000;
            }
            timer.schedule(new b(), 180000L, j);
        }
    }

    public int c() {
        return this.f;
    }

    public int d() {
        if (a(0L)) {
            return -101;
        }
        return g();
    }

    public boolean e() {
        return s.e(this.b) == 1;
    }

    public final void f() {
        if (a(0L)) {
            b(600000L);
        } else if (s.f(this.b) || e()) {
        } else {
            if (g() != 0) {
                b(600000L);
            } else if (e()) {
            } else {
                q qVar = new q(this.b, this, this.e, this.f, this.j);
                this.h = qVar;
                qVar.i();
            }
        }
    }

    public final int g() {
        String str = f577a;
        int i = 80;
        if (str != null && str != "") {
            String[] split = str.split(":");
            this.e = split[0];
            if (split.length > 1) {
                this.f = Integer.parseInt(split[1]);
            } else {
                this.f = 80;
            }
            return 0;
        }
        String a2 = a(0);
        String str2 = System.currentTimeMillis() + "";
        String b2 = s.b(this.b);
        if (b2 == null) {
            b2 = "";
        }
        String str3 = "timestamp=" + System.currentTimeMillis() + "&version=1&biz=" + this.c + "&os=2&id=" + b2 + "&sign=" + s.a("biz=" + this.c + "&timestamp=" + str2 + "&version=" + this.f578g + "&os=2&id=" + b2 + "&efa233");
        String b3 = s.b(a2 + "?" + str3);
        if (b3 == null || b3.isEmpty()) {
            b3 = s.b(a(1) + "?" + str3);
        }
        if (b3 == null || b3.isEmpty()) {
            b3 = s.b(a(2) + "?" + str3);
        }
        if (b3 == null || b3.isEmpty()) {
            b3 = s.b(a(3) + "?" + str3);
        }
        if (b3 == null || b3.equals("")) {
            return -1;
        }
        try {
            JSONObject jSONObject = new JSONObject(b3);
            int i2 = jSONObject.getInt("code");
            if (i2 != 0) {
                return i2;
            }
            JSONObject jSONObject2 = jSONObject.getJSONObject("data");
            String string = jSONObject2.getString("endpoint");
            this.d = string;
            String[] split2 = string.split(":");
            this.e = split2[0];
            if (split2.length > 1) {
                i = Integer.parseInt(split2[1]);
            }
            this.f = i;
            long j = jSONObject2.getLong("sleep");
            if (j > 0 && a(j)) {
                s.a(this.b, j);
                this.h = null;
                b(600000L);
                return -101;
            }
            try {
                String string2 = jSONObject2.getString("ip");
                com.unia.y.b bVar = this.j;
                if (bVar != null) {
                    bVar.a(string2);
                }
            } catch (Exception unused) {
            }
            return 0;
        } catch (JSONException unused2) {
            return -100;
        }
    }
}
